# Migration `20200418111310-migration`

This migration has been generated by marcel at 4/18/2020, 11:13:10 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Discipline" AS ENUM ('POWERLIFTING', 'SQUAT', 'BENCHPRESS', 'DEADLIFT');

CREATE TYPE "ContestType" AS ENUM ('SINGLE', 'TEAM');

CREATE TYPE "Gender" AS ENUM ('MALE', 'FEMALE');

CREATE TYPE "Role" AS ENUM ('ADMIN', 'USER', 'GUEST');

CREATE TYPE "Position" AS ENUM ('SEITENKAMPFRICHTER');

CREATE TABLE "public"."Event" (
    "contestType" "ContestType" NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "discipline" "Discipline" NOT NULL ,
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."Athlete" (
    "BD1" Decimal(65,30)  NOT NULL ,
    "BD2" Decimal(65,30)  NOT NULL ,
    "BD3" Decimal(65,30)  NOT NULL ,
    "KB1" Decimal(65,30)  NOT NULL ,
    "KB2" Decimal(65,30)  NOT NULL ,
    "KB3" Decimal(65,30)  NOT NULL ,
    "KH1" Decimal(65,30)  NOT NULL ,
    "KH2" Decimal(65,30)  NOT NULL ,
    "KH3" Decimal(65,30)  NOT NULL ,
    "ageClassId" text  NOT NULL ,
    "athleteNumber" integer  NOT NULL ,
    "birthday" timestamp(3)  NOT NULL ,
    "bodyWeight" Decimal(65,30)  NOT NULL ,
    "club" text  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "dots" Decimal(65,30)  NOT NULL ,
    "eventId" text  NOT NULL ,
    "firstName" text  NOT NULL ,
    "gender" "Gender" NOT NULL ,
    "id" text  NOT NULL ,
    "importId" integer  NOT NULL ,
    "lastName" text  NOT NULL ,
    "lateRegistration" boolean  NOT NULL ,
    "location" text  NOT NULL ,
    "los" integer  NOT NULL ,
    "nextAttemptsSortKeys" text  NOT NULL ,
    "norm" boolean  NOT NULL ,
    "place" integer  NOT NULL ,
    "points" Decimal(65,30)  NOT NULL ,
    "price" Decimal(65,30)  NOT NULL ,
    "raw" boolean  NOT NULL ,
    "resultClassId" text  NOT NULL ,
    "total" Decimal(65,30)  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    "weightClassId" text  NOT NULL ,
    "wilks" Decimal(65,30)  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."Slot" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "eventId" text  NOT NULL ,
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."AthleteGroup" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "eventId" text  NOT NULL ,
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    "slotId" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."Attempt" (
    "athleteId" text  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "date" timestamp(3)  NOT NULL ,
    "discipline" "Discipline" NOT NULL ,
    "done" boolean  NOT NULL ,
    "id" text  NOT NULL ,
    "index" integer  NOT NULL ,
    "raw" boolean  NOT NULL ,
    "resign" boolean  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    "valid" boolean  NOT NULL ,
    "weight" integer  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."WeightClass" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "gender" "Gender" NOT NULL ,
    "id" text  NOT NULL ,
    "max" integer  NOT NULL ,
    "min" Decimal(65,30)  NOT NULL ,
    "name" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."AgeClass" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    "sortId" integer  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."Official" (
    "club" text  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "eventId" text  NOT NULL ,
    "firstName" text  NOT NULL ,
    "id" text  NOT NULL ,
    "importId" integer  NOT NULL ,
    "lastName" text  NOT NULL ,
    "license" text  NOT NULL ,
    "location" text  NOT NULL ,
    "officalNumber" integer  NOT NULL ,
    "position" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."OfficialSlot" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "officialId" text  NOT NULL ,
    "position" "Position" NOT NULL ,
    "slotId" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."User" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "passwordHash" text  NOT NULL ,
    "role" "Role" NOT NULL DEFAULT 'GUEST',
    "salt" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    "username" text  NOT NULL ,
    PRIMARY KEY ("id")
)

ALTER TABLE "public"."Athlete" ADD FOREIGN KEY ("eventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Athlete" ADD FOREIGN KEY ("weightClassId")REFERENCES "public"."WeightClass"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Athlete" ADD FOREIGN KEY ("ageClassId")REFERENCES "public"."AgeClass"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Slot" ADD FOREIGN KEY ("eventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."AthleteGroup" ADD FOREIGN KEY ("eventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."AthleteGroup" ADD FOREIGN KEY ("slotId")REFERENCES "public"."Slot"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Attempt" ADD FOREIGN KEY ("athleteId")REFERENCES "public"."Athlete"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Official" ADD FOREIGN KEY ("eventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."OfficialSlot" ADD FOREIGN KEY ("officialId")REFERENCES "public"."Official"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."OfficialSlot" ADD FOREIGN KEY ("slotId")REFERENCES "public"."Slot"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200418111310-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,186 @@
+generator ts {
+  provider = "prisma-client-js"
+  output   = "./src/client"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+enum Discipline {
+    POWERLIFTING
+    SQUAT
+    BENCHPRESS
+    DEADLIFT
+}
+
+enum ContestType {
+    SINGLE
+    TEAM
+}
+
+enum Gender {
+    MALE
+    FEMALE
+}
+
+enum Role {
+    ADMIN
+    USER
+    GUEST
+}
+
+enum Position {
+    SEITENKAMPFRICHTER
+}
+
+model Event {
+    id                      String      @id @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    name                    String
+
+    discipline              Discipline
+    contestType             ContestType
+}
+
+model Athlete {
+    id                      String      @id @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    raw                     Boolean
+    athleteNumber           Int
+    firstName               String
+    lastName                String
+    gender                  Gender
+    club                    String
+    birthday                DateTime
+    total                   Float
+    norm                    Boolean
+    lateRegistration        Boolean
+    price                   Float
+    bodyWeight              Float
+    wilks                   Float
+    dots                    Float
+    los                     Int
+    KB1                     Float
+    KB2                     Float
+    KB3                     Float
+    BD1                     Float
+    BD2                     Float
+    BD3                     Float
+    KH1                     Float
+    KH2                     Float
+    KH3                     Float
+    points                  Float
+    place                   Int
+    location                String
+    nextAttemptsSortKeys    String
+    importId                Int
+
+    event                   Event           @relation(fields: [eventId], references: [id])
+    eventId                 String
+    weightClass             WeightClass     @relation(fields: [weightClassId], references: [id])
+    weightClassId           String
+    ageClass                AgeClass        @relation(fields: [ageClassId], references: [id])
+    ageClassId              String
+
+    resultClassId           String
+}
+
+model Slot {
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    name                    String
+
+    event                   Event       @relation(fields: [eventId], references: [id])
+    eventId                 String
+}
+
+model AthleteGroup {
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    name                    String
+
+    event                   Event       @relation(fields: [eventId], references: [id])
+    eventId                 String
+    slot                    Slot        @relation(fields: [slotId], references: [id])
+    slotId                  String
+}
+
+model Attempt {
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    discipline              Discipline
+    date                    DateTime
+    index                   Int
+    weight                  Int
+    raw                     Boolean
+    valid                   Boolean
+    done                    Boolean
+    resign                  Boolean
+
+    athlete                 Athlete     @relation(fields: [athleteId], references: [id])
+    athleteId               String
+}
+
+model WeightClass {
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    name                    String
+    gender                  Gender
+    min                     Float
+    max                     Int
+}
+
+model AgeClass {
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    name                    String
+    sortId                  Int
+}
+
+model Official {
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    officalNumber           Int
+    lastName                String
+    firstName               String
+    club                    String
+    license                 String
+    position                String
+    location                String
+    importId                Int
+
+    event                   Event       @relation(fields: [eventId], references: [id])
+    eventId                 String
+}
+
+model OfficialSlot {
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    position                Position
+
+    official                Official    @relation(fields: [officialId], references: [id])
+    officialId              String
+    slot                    Slot        @relation(fields: [slotId], references: [id])
+    slotId                  String
+}
+
+model User {
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    role                    Role        @default(GUEST)
+    username                String
+    passwordHash            String
+    salt                    String
+}
```

# Migration `20200222104648-migration`

This migration has been generated by marcel at 2/22/2020, 10:46:48 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Event" (
    "contestType" TEXT NOT NULL DEFAULT 'SINGLE' ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "discipline" TEXT NOT NULL DEFAULT 'POWERLIFTING' ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id")
) 

INSERT INTO "quaint"."new_Event" ("contestType", "discipline", "id", "name") SELECT "contestType", "discipline", "id", "name" FROM "quaint"."Event"

DROP TABLE "quaint"."Event";

ALTER TABLE "quaint"."new_Event" RENAME TO "Event";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Athlete" (
    "BD1" REAL NOT NULL DEFAULT 0 ,
    "BD2" REAL NOT NULL DEFAULT 0 ,
    "BD3" REAL NOT NULL DEFAULT 0 ,
    "KB1" REAL NOT NULL DEFAULT 0 ,
    "KB2" REAL NOT NULL DEFAULT 0 ,
    "KB3" REAL NOT NULL DEFAULT 0 ,
    "KH1" REAL NOT NULL DEFAULT 0 ,
    "KH2" REAL NOT NULL DEFAULT 0 ,
    "KH3" REAL NOT NULL DEFAULT 0 ,
    "ageClass" TEXT NOT NULL  ,
    "athleteNumber" INTEGER NOT NULL DEFAULT 0 ,
    "birthday" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "bodyWeight" REAL NOT NULL DEFAULT 0 ,
    "club" TEXT NOT NULL DEFAULT '' ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "dots" REAL NOT NULL DEFAULT 0 ,
    "event" TEXT NOT NULL  ,
    "firstName" TEXT NOT NULL DEFAULT '' ,
    "gender" TEXT NOT NULL DEFAULT 'MALE' ,
    "id" TEXT NOT NULL  ,
    "importId" INTEGER NOT NULL DEFAULT 0 ,
    "lastName" TEXT NOT NULL DEFAULT '' ,
    "lateRegistration" BOOLEAN NOT NULL DEFAULT false ,
    "location" TEXT NOT NULL DEFAULT '' ,
    "los" INTEGER NOT NULL DEFAULT 0 ,
    "nextAttemptsSortKeys" TEXT NOT NULL DEFAULT '' ,
    "norm" BOOLEAN NOT NULL DEFAULT false ,
    "place" INTEGER NOT NULL DEFAULT 0 ,
    "points" REAL NOT NULL DEFAULT 0 ,
    "price" REAL NOT NULL DEFAULT 0 ,
    "raw" BOOLEAN NOT NULL DEFAULT false ,
    "resultClassId" TEXT NOT NULL DEFAULT '' ,
    "total" REAL NOT NULL DEFAULT 0 ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "weightClass" TEXT NOT NULL  ,
    "wilks" REAL NOT NULL DEFAULT 0 ,
    PRIMARY KEY ("id"),FOREIGN KEY ("event") REFERENCES "Event"("id") ON DELETE RESTRICT ON UPDATE CASCADE,
FOREIGN KEY ("weightClass") REFERENCES "WeightClass"("id") ON DELETE RESTRICT ON UPDATE CASCADE,
FOREIGN KEY ("ageClass") REFERENCES "AgeClass"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_Athlete" ("BD1", "BD2", "BD3", "KB1", "KB2", "KB3", "KH1", "KH2", "KH3", "ageClass", "athleteNumber", "birthday", "bodyWeight", "club", "dots", "event", "firstName", "gender", "id", "importId", "lastName", "lateRegistration", "location", "los", "nextAttemptsSortKeys", "norm", "place", "points", "price", "raw", "resultClassId", "total", "weightClass", "wilks") SELECT "BD1", "BD2", "BD3", "KB1", "KB2", "KB3", "KH1", "KH2", "KH3", "ageClass", "athleteNumber", "birthday", "bodyWeight", "club", "dots", "event", "firstName", "gender", "id", "importId", "lastName", "lateRegistration", "location", "los", "nextAttemptsSortKeys", "norm", "place", "points", "price", "raw", "resultClassId", "total", "weightClass", "wilks" FROM "quaint"."Athlete"

DROP TABLE "quaint"."Athlete";

ALTER TABLE "quaint"."new_Athlete" RENAME TO "Athlete";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Slot" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "event" TEXT NOT NULL  ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("event") REFERENCES "Event"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_Slot" ("event", "id", "name") SELECT "event", "id", "name" FROM "quaint"."Slot"

DROP TABLE "quaint"."Slot";

ALTER TABLE "quaint"."new_Slot" RENAME TO "Slot";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_AthleteGroup" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "event" TEXT NOT NULL  ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    "slot" TEXT NOT NULL  ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("event") REFERENCES "Event"("id") ON DELETE RESTRICT ON UPDATE CASCADE,
FOREIGN KEY ("slot") REFERENCES "Slot"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_AthleteGroup" ("event", "id", "name", "slot") SELECT "event", "id", "name", "slot" FROM "quaint"."AthleteGroup"

DROP TABLE "quaint"."AthleteGroup";

ALTER TABLE "quaint"."new_AthleteGroup" RENAME TO "AthleteGroup";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Attempt" (
    "athlete" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "date" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "discipline" TEXT NOT NULL DEFAULT 'POWERLIFTING' ,
    "done" BOOLEAN NOT NULL DEFAULT false ,
    "id" TEXT NOT NULL  ,
    "index" INTEGER NOT NULL DEFAULT 0 ,
    "raw" BOOLEAN NOT NULL DEFAULT false ,
    "resign" BOOLEAN NOT NULL DEFAULT false ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "valid" BOOLEAN NOT NULL DEFAULT false ,
    "weight" INTEGER NOT NULL DEFAULT 0 ,
    PRIMARY KEY ("id"),FOREIGN KEY ("athlete") REFERENCES "Athlete"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_Attempt" ("athlete", "date", "discipline", "done", "id", "index", "raw", "resign", "valid", "weight") SELECT "athlete", "date", "discipline", "done", "id", "index", "raw", "resign", "valid", "weight" FROM "quaint"."Attempt"

DROP TABLE "quaint"."Attempt";

ALTER TABLE "quaint"."new_Attempt" RENAME TO "Attempt";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_WeightClass" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "gender" TEXT NOT NULL DEFAULT 'MALE' ,
    "id" TEXT NOT NULL  ,
    "max" INTEGER NOT NULL DEFAULT 0 ,
    "min" REAL NOT NULL DEFAULT 0 ,
    "name" TEXT NOT NULL DEFAULT '' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id")
) 

INSERT INTO "quaint"."new_WeightClass" ("gender", "id", "max", "min", "name") SELECT "gender", "id", "max", "min", "name" FROM "quaint"."WeightClass"

DROP TABLE "quaint"."WeightClass";

ALTER TABLE "quaint"."new_WeightClass" RENAME TO "WeightClass";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_AgeClass" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    "sortId" INTEGER NOT NULL DEFAULT 0 ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id")
) 

INSERT INTO "quaint"."new_AgeClass" ("id", "name", "sortId") SELECT "id", "name", "sortId" FROM "quaint"."AgeClass"

DROP TABLE "quaint"."AgeClass";

ALTER TABLE "quaint"."new_AgeClass" RENAME TO "AgeClass";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Official" (
    "club" TEXT NOT NULL DEFAULT '' ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "event" TEXT NOT NULL  ,
    "firstName" TEXT NOT NULL DEFAULT '' ,
    "id" TEXT NOT NULL  ,
    "importId" INTEGER NOT NULL DEFAULT 0 ,
    "lastName" TEXT NOT NULL DEFAULT '' ,
    "license" TEXT NOT NULL DEFAULT '' ,
    "location" TEXT NOT NULL DEFAULT '' ,
    "officalNumber" INTEGER NOT NULL DEFAULT 0 ,
    "position" TEXT NOT NULL DEFAULT '' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("event") REFERENCES "Event"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_Official" ("club", "event", "firstName", "id", "importId", "lastName", "license", "location", "officalNumber", "position") SELECT "club", "event", "firstName", "id", "importId", "lastName", "license", "location", "officalNumber", "position" FROM "quaint"."Official"

DROP TABLE "quaint"."Official";

ALTER TABLE "quaint"."new_Official" RENAME TO "Official";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_OfficialSlot" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "official" TEXT NOT NULL  ,
    "position" TEXT NOT NULL DEFAULT 'SEITENKAMPFRICHTER' ,
    "slot" TEXT NOT NULL  ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("slot") REFERENCES "Slot"("id") ON DELETE RESTRICT ON UPDATE CASCADE,
FOREIGN KEY ("official") REFERENCES "Official"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_OfficialSlot" ("id", "official", "position", "slot") SELECT "id", "official", "position", "slot" FROM "quaint"."OfficialSlot"

DROP TABLE "quaint"."OfficialSlot";

ALTER TABLE "quaint"."new_OfficialSlot" RENAME TO "OfficialSlot";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_User" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "passwordHash" TEXT NOT NULL DEFAULT '' ,
    "role" TEXT NOT NULL DEFAULT 'GUEST' ,
    "salt" TEXT NOT NULL DEFAULT '' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "username" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id")
) 

INSERT INTO "quaint"."new_User" ("id", "passwordHash", "role", "salt", "username") SELECT "id", "passwordHash", "role", "salt", "username" FROM "quaint"."User"

DROP TABLE "quaint"."User";

ALTER TABLE "quaint"."new_User" RENAME TO "User";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200222102535-init..20200222104648-migration
--- datamodel.dml
+++ datamodel.dml
@@ -4,9 +4,9 @@
 }
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url      = "sqlite:./data.db"
 }
 enum Discipline {
     POWERLIFTING
@@ -26,25 +26,30 @@
 }
 enum Role {
     ADMIN
+    USER
     GUEST
 }
 enum Position {
     SEITENKAMPFRICHTER
 }
 model Event {
-    id                      String      @id
+    id                      String      @id @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     name                    String
     discipline              Discipline
     contestType             ContestType
 }
 model Athlete {
-    id                      String      @id
+    id                      String      @id @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     raw                     Boolean
     athleteNumber           Int
     firstName               String
     lastName                String
@@ -81,24 +86,30 @@
     resultClassId           String
 }
 model Slot {
-    id                      String      @id
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     name                    String
     event                   Event
 }
 model AthleteGroup {
-    id                      String      @id
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     name                    String
     event                   Event
     slot                    Slot
 }
 model Attempt {
-    id                      String      @id
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     discipline              Discipline
     date                    DateTime
     index                   Int
     weight                  Int
@@ -110,23 +121,29 @@
     athlete                 Athlete
 }
 model WeightClass {
-    id                      String      @id
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     name                    String
     gender                  Gender
-    min                     Int
+    min                     Float
     max                     Int
 }
 model AgeClass {
-    id                      String      @id
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     name                    String
     sortId                  Int
 }
 model Official {
-    id                      String      @id
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     officalNumber           Int
     lastName                String
     firstName               String
     club                    String
@@ -138,18 +155,22 @@
     event                   Event
 }
 model OfficialSlot {
-    id                      String      @id
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
     position                Position
     official                Official
     slot                    Slot
 }
 model User {
-    id                      String      @id
-    role                    Role
+    id                      String      @id  @default(uuid())
+    createdAt               DateTime    @default(now())
+    updatedAt               DateTime    @updatedAt
+    role                    Role        @default(GUEST)
     username                String
     passwordHash            String
     salt                    String
 }
```


